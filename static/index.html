<!DOCTYPE HTML>
<html>
	<head>
		<title>Metadata Crawler</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="HandheldFriendly" content="True" />
		<meta property="og:locale" content="en_US" />
		<!-- Unique for each site -->
		<meta property="og:url" content="https://crawler.biothings.io/">
    <meta property="og:site_name" content="Metadata Crawler">
    <meta property="og:title" content="Metadata Crawler" />
    <meta name="description" content="Serving structured dataset metadata with Biothings API in schema.org standard" />
    <meta property="og:image" content="https://i.postimg.cc/nrsFNFCZ/featured.jpg">
    <meta property="og:image:type" content="image/jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:type" content="website">
    <meta property="og:description" content="Serving structured dataset metadata with Biothings API in schema.org standard">
    <meta property="fb:app_id" content="" />
    <meta name="twitter:title" content="Metadata Crawler" />
    <meta name="twitter:url" content="https://crawler.biothings.io/" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:description" content="Serving structured dataset metadata with Biothings API in schema.org standard" />
		<!-- IMAGES -->
		<link rel="apple-touch-icon" href="/static/img/apple-touch-icon.png" />
    <meta name="twitter:image" content="/static/img/favicon.ico" />
		<link rel="apple-touch-icon" sizes="57x57" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="72x72" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="76x76" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="114x114" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="120x120" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="144x144" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="152x152" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="180x180" href="/static/img/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
		<link rel="manifest" href="/static/img/site.webmanifest">
		<link rel="mask-icon" href="/static/img/safari-pinned-tab.svg" color="#3366cc">
		<meta name="msapplication-config" content="/static/img/browserconfig.xml">
		<meta name="msapplication-TileColor" content="#5bbad5">
		<meta name="theme-color" content="#5bbad5">
		<link rel="shortcut icon" type="image/png" href="/static/img/favicon.ico"/>
		<!-- Styles -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
		<link rel="stylesheet" href="/static/css/app.css" />
		<link href="https://fonts.googleapis.com/css?family=Darker+Grotesque|Hepta+Slab&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
	</head>
	<body>
    <div id="app">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand text-main" href="/">
          <img src="/static/img/crawler.svg" width="30" height="30" class="d-inline-block align-top" alt="logo">  <span class="d-none d-md-inline text-main">Metadata <b class="text-sec">Crawler</b></span>
        </a>
        <li class="nav-item d-block d-md-none">
          <a class="nav-link btn bg-dark text-light" href="#tryit">Try API</a>
        </li>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#tryit">API</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="#sources">Sources</a>
            </li>
          </ul>
        </div>
      </nav>
      <section class="container-fluid d-flex justify-content-center align-items-center full">
        <div class="p-2 w-75 text-center">
          <img src="/static/img/crawlerfull.svg" alt="Metadata Crawler" class="d-none d-md-block"/>
          <img src="/static/img/crawler.svg" alt="Metadata Crawler" class="d-block d-md-none w-50 m-auto"/>
          <h1 id="biothings-crawler" class="text-main d-block d-md-none text-center"><span class="text-main">Metadata <b class="text-sec">Crawler</b></span></h1>
          <h4>
            Serving structured dataset metadata with <a href="https://biothings.io" target="_blank" rel="noreferrer">Biothings API</a> in <a href="https://schema.org/" target="_blank" rel="noreferrer">Schema.org</a> standard.
          </h4>
          <p class="text-center text-muted">Learn more on <a href="https://github.com/biothings/biothings.crawler" target="_blank" rel="noreferrer">Github</a></p>
          <p class="text-center text-muted">
            <small>Last updated: Jan 2020</small>
          </p>
          <div class="p-3 text-center">
            <a class="text-sec" href="#tryit" style="font-size:3rem; text-decoration:none;">TRY IT</a>
          </div>

        </div>
      </section>
      <section class="container-fluid jumbotron bg-white d-flex justify-content-center align-items-center" id="sources">
        <div class="w-100 m-0 row">
          <svg class="col-sm-12 col-md-6" version="1.1" id="web" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          	 viewBox="0 0 575 280" style="enable-background:new 0 0 575 280;" xml:space="preserve">
          <polyline style="fill:none;stroke:#4776C9;stroke-miterlimit:10;" points="281.5,142 281.5,54.5 281.5,226.5 281.5,141.5
          	377.5,140.5 184.5,143.5 281.5,141.5 214.1,207.8 353.1,70.8 281.5,141.5 353.5,210.5 195.5,62.5 250.5,113.5 240.5,142.5
          	252.5,170.5 281.5,185.5 312.5,171.5 324.5,141.5 309.5,113.5 281.5,101.5 250.5,113.5 226.5,90.5 203.5,143.5 225.5,196.5
          	281.5,215.5 335.5,192.5 356.5,140.5 334.5,87.5 281.5,68.5 226.5,90.5 "/>
          <path style="fill:#26468C;" d="M306,157.2l-5.9-43.9l-12.6,22.2c-1.4-2.2-3.6-3.6-6.1-3.6c-2.5,0-4.6,1.4-6,3.5l-12.6-22.1
          	l-5.9,43.9l8.3-31.3l8.8,13.1c-0.1,0.6-0.2,1.3-0.2,2c0,1.9,0.5,3.6,1.3,5.1l-2.6-0.8l9,13.7l-2.5-6.7c0.7,0.3,1.5,0.5,2.4,0.5
          	c1,0,1.9-0.2,2.6-0.6l-2.5,6.8l9.1-13.7l-2.9,0.8c0.9-1.5,1.4-3.2,1.4-5.2c0-0.7-0.1-1.3-0.2-1.9l8.8-13.2L306,157.2z"/>
          </svg>
          <div class="col-sm-12 col-md-6">
            <h1 class="text-left text-sec">Crawled Sources Include:</h1>
            <div class="w-100 text-left">
              <template v-for="(item,i) in dbs" >
                <div :key="i" class="p-2">
                  <h4><b v-text="item"></b> <i class="fas fa-check text-sec"></i></h4>
                </div>
              </template>
            </div>
          </div>
        </div>
      </section>
      <section class="container-fluid bg-main d-flex justify-content-center align-items-center full">
        <div class="text-light text-center w-100">
          <h1 class="mb-5" id="tryit">
            TRY THE API
          </h1>
          <form class="d-flex justify-content-center flex-wrap w-100 m-0 row" @submit.prevent="callApi()">
            <div class="form-group p-1 col-sm-12 col-md-6 m-auto">
              <template v-if="querySelectionType==='example'">
                <select v-model="querySelected" class="form-control scale-in-center w-100" id="exampleFormControlSelect1">
                  <template v-for="item in exampleQueries">
                    <option :value="item" v-text="item"></option>
                  </template>
                </select>
              </template>
              <template v-if="querySelectionType==='own'">
                <input v-model="querySelected" type="text" class="form-control scale-in-center w-100" id="exampleFormControlInput1" placeholder="enter query here">
              </template>
              <button class="btn text-light scale-in-center m-2" type="submit" :class="querySelected?'btn-outline-light':'disabled btn-outline-secondary'">Submit</button>
              <label class="text-sec" v-if="!querySelected" for="api">Select a query</label>
              <div class="form-check text-left mt-3">
                <input v-model="querySelectionType" class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="example" checked>
                <label class="form-check-label" for="exampleRadios1">
                  Example Queries
                </label>
              </div>
              <div class="form-check text-left">
                <input @click="querySelected=''" v-model="querySelectionType" class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="own">
                <label class="form-check-label" for="exampleRadios2">
                  Write My Own Query
                </label>
              </div>
            </div>
          </form>
          <div v-show='loading' class="text-center text-light">
            <i class="fas fa-spinner fa-pulse"></i> Loading
          </div>
          <pre v-show="success" id="callResults" class="p-2 bg-light text-left m-auto container" style="max-height: 800px; overflow: scroll; border-radius: 5px;">

          </pre>
        </div>
      </section>
      <footer class="bg-sec p-3" style="bottom:0;">
        <div class="text-center text-light">
          <a href="https://github.com/biothings/biothings.crawler" target="_blank" class="text-light">
            <i class="fab fa-github-alt fa-2x"></i>
          </a>
          <hr />
          <p class="m-0">
            All content copyright <a href="http://BioThings.io/" class="text-light">BioThings.io</a> © <span id="year"></span> <br /> All rights reserved.
          </p>
        </div>
      </footer>
      </div>
  		<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.2/vue.min.js"></script>
  		<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/solid.js" integrity="sha384-+Ga2s7YBbhOD6nie0DzrZpJes+b2K1xkpKxTFFcx59QmVPaSA8c7pycsNaFwUK6l" crossorigin="anonymous"></script>
  		<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/brands.js" integrity="sha384-sCI3dTBIJuqT6AwL++zH7qL8ZdKaHpxU43dDt9SyOzimtQ9eyRhkG3B7KMl6AO19" crossorigin="anonymous"></script>
  		<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/fontawesome.js" integrity="sha384-7ox8Q2yzO/uWircfojVuCQOZl+ZZBg2D2J5nkpLqzH1HY0C1dHlTKIbpRz/LG23c" crossorigin="anonymous"></script>
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/vivus/0.4.3/vivus.js"></script>
  		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/gsap.min.js" integrity="sha256-cyEXrJKjO3YNkpCjPxVBdi7pRJ3EF+okm1oN9Qc4rRY=" crossorigin="anonymous"></script>
  		<script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
  		<script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
  		<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.min.js" integrity="sha256-+9YNuItWuR4sbqeaNiJOxG0BvptYz4fbUXbIZoH5Jwo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
      <script src="/static/js/renderjson.js"></script>
      <script>
        var app = new Vue({
          el: '#app',
          data: function(){
            return {
              "title":"Metadata Crawler",
              success: false,
              loading: false,
              loadingExamples: false,
              exampleQueries:[
                '/api/query?q=virus',
                '/api/query?q=__any__'
              ],
              dbs:[],
              querySelected:'',
              queryString:'',
              querySelectionType:'example',
            }
          },
          watch:{

          },
          methods:{
            callApi(){
              let self = this;
              let myUrl = self.querySelected;


              if (myUrl) {
                $('#callResults').html('');
                self.loading = true;

                axios.get(myUrl+`&timestamp=${new Date().getTime()}`).then(res=>{
                  self.loading = false;
                  renderjson.set_show_to_level(7);
                  $('#callResults').html( renderjson(res.data) );
                  self.success = true;
                }).catch(err=>{
                  alert(err)
                  self.loading = false;
                  renderjson.set_show_to_level(7);
                  $('#callResults').html( err );
                  self.success = false;
                  throw err;
                });
              }
            },
            prepareAnimation(){
              function pathPrepare ($el) {
            		var lineLength = $el[0].getTotalLength();
            		$el.css("stroke-dasharray", lineLength);
            		$el.css("stroke-dashoffset", lineLength);
            	}

            	var poly = $("polyline");

            	// prepare SVG
            	pathPrepare(poly);

            	// init controller
            	var controller = new ScrollMagic.Controller();

            	// build tween
            	var tween = new TimelineMax()
            		.add(TweenMax.to(poly, 0.9, {strokeDashoffset: 0, ease:Linear.easeNone})) // draw word for 0.9

            	// build scene
            	var scene = new ScrollMagic.Scene({triggerElement: "#sources", duration: 400, tweenChanges: true})
            					.setTween(tween)
            					// .addIndicators() // add indicators (requires plugin)
            					.addTo(controller);


              document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  					    anchor.addEventListener('click', function (e) {
  					        e.preventDefault();
  					        document.querySelector(this.getAttribute('href')).scrollIntoView({
  					            behavior: 'smooth'
  					        });
  					    });
  					});

            }

        },
        mounted:function(){
          var self = this;
          self.prepareAnimation();

          let sources = "{{sources}}";
          if (sources) {
            try {
              let parser = new DOMParser;
              let dom = parser.parseFromString(sources,'text/html');
              let decodedString = dom.body.textContent;
              let list = eval(decodedString);
              let names =[]
              for (var i = 0; i < list.length; i++) {
                names.push(list[i]['name'])
              }
              console.log('from server');
              self.dbs = names;

            } catch (e) {
              console.log('default names');
              self.dbs = [
                "Omicsdi",
                "Zenodo",
                "Harvard Dataverse",
                "NCBI Geo",
                "ImmPort",
                "NYU Data Catalog",
                "CTSA Data Discovery Engine",
              ]
            }
          }

          var currentTime = new Date()
          var year = currentTime.getFullYear()
          var myelement = document.getElementById("year");
              myelement.innerHTML= year;
        }
        })
    </script>
	</body>
</html>
